import{r as h,o as t,c as o,F as x,l as y,t as a,a1 as I,A as X,u as Y,x as B,b as Z,d as u,e as ee,a as n,f as e,h as c,i as S,j as r,m as N,k as L,a2 as se,w as te,g as oe,n as ne,B as le,H as ae,p as ie,E as j,q as ce,v as re}from"./index.91bfe48e.js";import{a as de,b as _e,w as q}from"./chat.9bf36888.js";import{u as ue}from"./upload.91f57f6a.js";import{s as pe}from"./store.d85733ee.js";import{b as fe,_ as he}from"./user.813e9704.js";import{a as me,k as ge}from"./order.8f5e59e0.js";import{_ as ve}from"./home.195defe7.js";import{a as be}from"./blocks.92918655.js";const xe={class:"uni-flow l-h20"},ye={emits:["click"],setup(m,{emit:g}){const z=h(["\u{1F603}","\u{1F604}","\u{1F601}","\u{1F62D}","\u{1F606}","\u{1F605}","\u{1F923}","\u{1F602}","\u{1F637}","\u{1F61B}","\u{1F642}","\u{1F643}","\u{1F609}","\u{1F60A}","\u{1F607}","\u{1F970}","\u{1F60D}","\u{1F929}","\u{1F618}","\u{1F617}","\u{1F61A}","\u{1F911}","\u{1F974}","\u{1F635}"]),v=d=>{g("click",d.target)};return(d,w)=>(t(),o("div",xe,[(t(!0),o(x,null,y(z.value,i=>(t(),o("span",{onClick:v,class:"mb5 ml5 inline-block pointer"},a(i),1))),256))]))}};const V=m=>(ce("data-v-268a23f8"),m=m(),re(),m),we={class:"main"},ke={class:"w chatbox"},Ce={class:"hd pl10 ml5 vertical-middle"},Ie={class:"uni-flex uni-column bgf item pointer"},Le=["onClick"],Se={class:"uni-flex uni-row flex-middle"},ze={class:"portrait"},Te={class:"uni-flex uni-column pt5 pb5 ml10 f-13 width-surplus"},Me={class:"uni-flex uni-row flex-middle width-between"},Re={class:"bold line-clamp-1 name"},Ve={class:"f-10 f-gray"},$e={key:0,class:"f-gray f-10 mt5"},Ee={key:1,class:"f-gray line-clamp-1 f-10 mt5"},He={key:0,class:"absolute f-white f-10"},Oe={key:0,class:"unread"},Be={key:1,class:"unread"},Ne=["onClick"],je={class:"uni-flex uni-row flex-middle"},qe={class:"portrait"},De={class:"uni-flex uni-column pt5 pb5 ml10 f-13 width-surplus"},Fe={class:"uni-flex uni-row flex-middle width-between"},Ke={class:"bold line-clamp-1 name"},Ue={class:"f-10 f-gray"},Ae={key:0,class:"f-gray f-10 mt5"},Je={key:1,class:"f-gray line-clamp-1 f-10 mt5"},Ge={key:0,class:"absolute f-white f-10"},Pe={key:0,class:"unread"},Qe={key:1,class:"unread"},We={class:"uni-flex uni-row hd ml10 flex-middle"},Xe={key:0,class:"iconfont icon-shangjialiebiaoicon mr5"},Ye={class:"bold"},Ze={class:"bd ml10"},es={class:"uni-flex uni-column pd10 mt10"},ss={key:0,class:"uni-flex uni-row mb10 flex-end"},ts={class:"mr10 text-right"},os={class:"f-gray f-12"},ns=["innerHTML"],ls={class:"portrait"},as={key:1,class:"uni-flex uni-row mb10"},is={class:"portrait"},cs={class:"ml10"},rs={class:"flex-middle"},ds={class:"ml10 f-gray f-12"},_s=["innerHTML"],us={class:"fd mb20"},ps={class:"pl10 pt10 relative ml10"},fs={class:"meta absolute uni-flex uni-row flex-middle"},hs=V(()=>e("i",{class:"iconfont icon-tupian pointer f-18 f-gray"},null,-1)),ms=V(()=>e("i",{class:"iconfont icon-biaoqing pointer f-18 f-gray"},null,-1)),gs={class:"text-right ml10 mr10"},vs=S("\u53D1\u9001(Enter)"),bs={class:"pd10 mg5"},xs=V(()=>e("div",{style:{height:"26px"}},null,-1)),ys={class:"bgf round-edge mg5"},ws={key:0,class:"uni-flex uni-row pd10"},ks=["src"],Cs={class:"ml10 f-13"},Is={class:"flex-middle"},Ls={class:"mr5"},Ss=["src"],zs=S("\u8FDB\u5165\u5E97\u94FA"),Ts={class:"orders pd10"},Ms={class:"hd bold pb10"},Rs={class:"bd"},Vs={class:"f-12 f-gray mb5"},$s={class:"uni-flex uni-row"},Es=["src"],Hs={class:"f-12 ml5"},Os=["title"],Bs={class:"f-red mt5 mb5"},Ns={setup(m){const g=h(I),{proxy:z}=X(),v=h(!1),d=Y(),w=h({}),i=B({touser:"",list:[],logs:[]}),f=B({content:""}),_=h({}),b=h({});Z(()=>{w.value=JSON.parse(localStorage.getItem("visitor"))||{},setInterval(()=>{K()},4e3),E(),setInterval(()=>{E()},3e3),d.params.store_id>0?pe(d.params,l=>{_.value=l,i.touser=l.store_name,me({store_id:l.store_id,queryitem:!0},p=>{b.value=p.list},v)}):fe({userid:d.params.id},l=>{i.touser=l.nickname||l.username,ge({buyer_name:l.username,queryitem:!0},p=>{b.value=p.list},v)})});const $=()=>{d.params.id?f.content.replace(/<[^>]+>/g,"").replace(/\s*/g,"")==""?j.error("\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A"):q(Object.assign(f,{toid:d.params.id,store_id:parseInt(d.params.store_id)}),l=>{f.content=""}):j.error("\u8BF7\u9009\u62E9\u4F1A\u8BDD\u7528\u6237")},D=l=>{ue(l.raw,{folder:"webim/"},p=>{let T='<img width="100" src="'+p.fileUrl+'" />';q({content:T,toid:d.params.id,store_id:parseInt(d.params.store_id)},H=>{})})},F=l=>{f.content+=l.innerHTML};function K(){de({limit:50},l=>{i.list=l})}function E(){_e({toid:d.params.id,page_size:100},l=>{l.list.length>0&&(i.logs.length==0||i.logs.length>0&&l.list[l.list.length-1].id>i.logs[i.logs.length-1].id)&&(i.logs=l.list,z.$nextTick(()=>{setTimeout(()=>{g.value&&g.value.setScrollTop(1e7)},1e3)}))})}return(l,p)=>{const T=u("ChatRound"),H=u("el-icon"),k=u("el-avatar"),M=u("el-col"),U=u("el-upload"),A=u("el-popover"),J=u("el-input"),G=u("el-button"),O=u("el-tag"),P=u("router-link"),Q=u("el-row"),W=ee("loading");return t(),o("div",we,[n(ve,{exclude:["category","searchbox","imagead"]}),e("div",ke,[n(Q,{class:"round-edge wraper"},{default:c(()=>[n(M,{span:5,class:"panel"},{default:c(()=>[e("div",Ce,[n(H,{size:18,class:"mr5"},{default:c(()=>[n(T)]),_:1}),S("\u804A\u5929\u5217\u8868("+a(r(i).list.length)+") ",1)]),n(r(I),{height:"550px"},{default:c(()=>[(t(!0),o(x,null,y(r(i).list,s=>(t(),o("div",Ie,[w.value.userid==s.store_id?(t(),o("div",{key:0,onClick:R=>r(N)("/webim/chat/"+s.to.userid),class:"uni-flex uni-row pd10 flex-middle width-between relative"},[e("div",Se,[e("div",ze,[n(k,{src:s.to.portrait,size:40},null,8,["src"])]),e("div",Te,[e("p",Me,[e("span",Re,a(s.to.nickname||s.to.username),1),e("label",Ve,a(s.created),1)]),s.content.indexOf("<img")>-1?(t(),o("span",$e,"[\u56FE\u7247]")):(t(),o("span",Ee,a(s.content.replace(/<[^>]+>/g,"")),1))])]),s.unreads>0?(t(),o("div",He,[s.unreads>10?(t(),o("span",Oe,"10+")):(t(),o("span",Be,a(s.unreads),1))])):L("",!0)],8,Le)):(t(),o("div",{key:1,onClick:R=>r(N)("/webim/chat/"+s.to.userid+"/"+parseInt(s.store_id)),class:"uni-flex uni-row pd10 flex-middle width-between relative"},[e("div",je,[e("div",qe,[n(k,{src:s.to.portrait,size:40},null,8,["src"])]),e("div",De,[e("p",Fe,[e("span",Ke,a(s.store_name||s.to.nickname||s.to.username),1),e("label",Ue,a(s.created),1)]),s.content.indexOf("<img")>-1?(t(),o("span",Ae,"[\u56FE\u7247]")):(t(),o("span",Je,a(s.content.replace(/<[^>]+>/g,"")),1))])]),s.unreads>0?(t(),o("div",Ge,[s.unreads>10?(t(),o("span",Pe,"10+")):(t(),o("span",Qe,a(s.unreads),1))])):L("",!0)],8,Ne))]))),256))]),_:1})]),_:1}),n(M,{span:13,class:"gallery"},{default:c(()=>[e("div",We,[_.value.store_id?(t(),o("i",Xe)):L("",!0),e("p",Ye,a(_.value.store_id?r(i).touser:"\u4E0E\u201C"+r(i).touser+"\u201D\u4F1A\u8BDD\u4E2D"),1)]),e("div",Ze,[n(r(I),{ref_key:"scrollbarRef",ref:g,height:"400px"},{default:c(()=>[(t(!0),o(x,null,y(r(i).logs,s=>(t(),o("div",es,[s.fromid==w.value.userid?(t(),o("div",ss,[e("div",ts,[e("div",null,[e("span",os,a(s.created),1)]),e("div",{class:"detail-info pd10 mb10 bgp round-edge inline-block",innerHTML:s.content},null,8,ns)]),e("div",ls,[n(k,{src:s.from.portrait,size:40},null,8,["src"])])])):(t(),o("div",as,[e("div",is,[n(k,{src:s.from.portrait,size:40},null,8,["src"])]),e("div",cs,[e("div",rs,[e("span",null,a(s.from.nickname||s.from.username),1),e("span",ds,a(s.created),1)]),e("div",{class:"detail-info pd10 mb10 bgf round-edge inline-block",innerHTML:s.content},null,8,_s)])]))]))),256))]),_:1},512)]),e("div",us,[e("div",ps,[e("div",fs,[n(U,{action:"#","show-file-list":!1,"auto-upload":!1,"on-change":D,class:"mr10"},{default:c(()=>[hs]),_:1}),n(A,{placement:"top-start",width:200,trigger:"click"},{reference:c(()=>[ms]),default:c(()=>[n(ye,{onClick:F})]),_:1})]),n(J,{modelValue:r(f).content,"onUpdate:modelValue":p[0]||(p[0]=s=>r(f).content=s),type:"textarea",class:"textarea",placeholder:"\u8BF7\u8F93\u5165\u6D88\u606F\uFF0C\u6309\u53D1\u9001\u952E\u53D1\u9001",resize:"none",onKeyup:se($,["enter","native"])},null,8,["modelValue","onKeyup"])]),e("div",gs,[n(G,{onClick:$,class:"send",type:"primary"},{default:c(()=>[vs]),_:1})])])]),_:1}),n(M,{span:6},{default:c(()=>[e("div",bs,[xs,te((t(),o("div",ys,[_.value.store_id?(t(),o("div",ws,[e("p",null,[e("img",{src:_.value.store_logo,width:"44"},null,8,ks)]),e("p",Cs,[e("span",Is,[e("label",Ls,a(_.value.store_name),1),e("img",{src:_.value.credit_image,width:"13"},null,8,Ss)]),n(P,{to:"/store/index/"+_.value.store_id,class:"rlink block mt5 f-12"},{default:c(()=>[n(O,null,{default:c(()=>[zs]),_:1})]),_:1},8,["to"])])])):L("",!0),b.value.length>0?(t(),oe(r(I),{key:1,height:_.value.store_id?"456px":"524px"},{default:c(()=>[e("div",Ts,[e("div",Ms,a(_.value.store_id?"\u6211\u7684\u8BA2\u5355":"\u5DF2\u4E0B\u5355"),1),e("div",Rs,[(t(!0),o(x,null,y(b.value,(s,R)=>(t(),o("div",{class:ne(["item round-edge bgp pl10 pt5 pr10 pb5",R==b.value.length-1?"":"mb10"])},[e("p",Vs,"\u8BA2\u5355\u53F7\uFF1A"+a(s.order_sn),1),(t(!0),o(x,null,y(s.items,C=>(t(),o("div",$s,[e("p",null,[e("img",{class:"round-edge",src:C.goods_image,width:"66"},null,8,Es)]),e("div",Hs,[e("p",{class:"line-clamp-1",title:C.goods_name},a(C.goods_name),9,Os),e("p",Bs,a(r(le)(C.price)),1),n(O,{type:"warning"},{default:c(()=>[S(a(r(ae)(s.status)),1)]),_:2},1024)])]))),256))],2))),256))])])]),_:1},8,["height"])):(t(),o("div",{key:2,class:"flex-middle flex-center f-gray",style:ie(_.value.store_id?"height:456px":"height:524px")},"\u6682\u65E0\u8BA2\u5355/\u5546\u54C1\u4FE1\u606F",4))])),[[W,v.value]])])]),_:1})]),_:1})]),n(he)])}}};var Gs=be(Ns,[["__scopeId","data-v-268a23f8"]]);export{Gs as default};
