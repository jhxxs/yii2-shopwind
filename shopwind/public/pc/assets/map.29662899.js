import{o as j,c as Y,k as ot,V as at,n as ut,p as ft,r as q,x as gt,b as mt,d as H,a as E,f as $,h as A,F as _t,g as vt,j as z,i as st,q as yt,v as bt,E as wt}from"./index.63485ad7.js";import{s as xt,b as Mt}from"./store.555a5057.js";import{a as Ct,s as Bt}from"./blocks.ed01be35.js";import{m as St}from"./seller.19de717e.js";import{_ as kt}from"./user.ca2642db.js";import{m as It}from"./seller.72cf562b.js";import"./chat.2d6ea877.js";var Tt={"bm-map":["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],"bm-geolocation":["locationSuccess","locationError"],"bm-overview-map":["viewchanged","viewchanging"],"bm-marker":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],"bm-polyline":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-polygon":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-circle":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-label":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","rightclick"],"bm-info-window":["close","open","maximize","restore","clickclose"],"bm-ground":["click","dblclick"],"bm-autocomplete":["onconfirm","onhighlight"],"bm-point-collection":["click","mouseover","mouseout"]};function J(t,h){const o=h||Tt[this.$options.name];o&&o.forEach(u=>{let m=u.slice(0,2)==="on"?u.slice(2):u;const e=this.$attrs["on"+m.replace(m[0],m[0].toUpperCase())];e&&t.addEventListener(u,e)})}function F(t,h={}){const{lng:o,lat:u}=h;return new t.Point(o,u)}function O(t,h={}){const{width:o,height:u}=h;return new t.Size(o,u)}function K(t,h={}){const{url:o,size:u,opts:v={}}=h;let m={anchor:v.anchor&&O(t,v.anchor),imageSize:v.imageSize&&O(t,v.imageSize),imageOffset:v.imageOffset&&O(t,v.imageOffset),infoWindowAnchor:v.infoWindowAnchor&&O(t,v.infoWindowAnchor),printImageUrl:v.printImageUrl};return R(m),new t.Icon(o,O(t,u),m)}function Pt(t,h={}){const{content:o,opts:u}=h;let v={offset:u.offset&&O(t,u.offset),position:u.position&&F(t,u.position),enableMassClear:u.enableMassClear};return R(v),new t.Label(o,v)}const it=t=>Object.prototype.toString.call(t).slice(8,-1),R=t=>{Object.keys(t).forEach(h=>{typeof t[h]=="undefined"&&delete t[h]})};let X={v:"3.0",type:"API"};const Et=(t={})=>{X=Object.assign(X,t),X.ak||console.error("\u8BF7\u914D\u7F6Eak\uFF1A\u767E\u5EA6\u5730\u56FE\u5F00\u53D1\u8005\u5E73\u53F0\u7533\u8BF7\u7684\u5BC6\u94A5")},L=()=>X;var Z=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Q={exports:{}};function tt(){}tt.prototype={on:function(t,h,o){var u=this.e||(this.e={});return(u[t]||(u[t]=[])).push({fn:h,ctx:o}),this},once:function(t,h,o){var u=this;function v(){u.off(t,v),h.apply(o,arguments)}return v._=h,this.on(t,v,o)},emit:function(t){var h=[].slice.call(arguments,1),o=((this.e||(this.e={}))[t]||[]).slice(),u=0,v=o.length;for(u;u<v;u++)o[u].fn.apply(o[u].ctx,h);return this},off:function(t,h){var o=this.e||(this.e={}),u=o[t],v=[];if(u&&h)for(var m=0,e=u.length;m<e;m++)u[m].fn!==h&&u[m].fn._!==h&&v.push(u[m]);return v.length?o[t]=v:delete o[t],this}};Q.exports=tt;Q.exports.TinyEmitter=tt;var Ot=Q.exports,V=new Ot,D={$on:(...t)=>V.on(...t),$once:(...t)=>V.once(...t),$off:(...t)=>V.off(...t),$emit:(...t)=>V.emit(...t)};const nt={API:{"2.0":{setMapStyle:"setMapStyle",NavigationControl:"NavigationControl"},"3.0":{setMapStyle:"setMapStyleV2",NavigationControl:"NavigationControl"}},WebGL:{setMapStyle:"setMapStyleV2",NavigationControl:"NavigationControl3D"}},W=t=>{const h=L();return h.type=="WebGL"?nt[h.type][t]:nt[h.type][h.v][t]};var rt=(t,h)=>{const o=t.__vccOpts||t;for(const[u,v]of h)o[u]=v;return o};const At={name:"bm-map",inheritAttrs:!1,emits:["ready","init","animationed"],props:{ak:{type:String},v:{type:String},type:{type:String},center:{type:[Object,String]},zoom:{type:Number},minZoom:{type:Number},maxZoom:{type:Number},highResolution:{type:Boolean,default:!0},mapClick:{type:Boolean,default:!0},mapType:{type:String},dragging:{type:Boolean,default:!0},scrollWheelZoom:{type:Boolean,default:!1},doubleClickZoom:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},inertialDragging:{type:Boolean,default:!0},continuousZoom:{type:Boolean,default:!0},pinchToZoom:{type:Boolean,default:!0},autoResize:{type:Boolean,default:!0},theme:{type:Array},mapStyle:{type:Object},hasAnimation:{type:Boolean,default:!0},defaultAnimation:{type:Boolean,default:!0}},watch:{center(t,h){const{map:o,zoom:u}=this;it(t)==="String"&&t!==h&&this.setCenterZoom(o,t,u)},"center.lng"(t,h){const{BMap:o,map:u,zoom:v,center:m}=this;t!==h&&t>=-180&&t<=180&&this.setCenterZoom(u,new o.Point(t,m.lat),v)},"center.lat"(t,h){const{BMap:o,map:u,zoom:v,center:m}=this;t!==h&&t>=-74&&t<=74&&this.setCenterZoom(u,new o.Point(m.lng,t),v)},zoom(t,h){const{map:o}=this;t!==h&&t>=3&&t<=19&&o.setZoom(t)},minZoom(t){const{map:h}=this;h.setMinZoom(t)},maxZoom(t){const{map:h}=this;h.setMaxZoom(t)},highResolution(){this.reset()},mapClick(){this.reset()},mapType(t){const{map:h}=this;h.setMapType(window[t])},dragging(t){const{map:h}=this;t?h.enableDragging():h.disableDragging()},scrollWheelZoom(t){const{map:h}=this;t?h.enableScrollWheelZoom():h.disableScrollWheelZoom()},doubleClickZoom(t){const{map:h}=this;t?h.enableDoubleClickZoom():h.disableDoubleClickZoom()},keyboard(t){const{map:h}=this;t?h.enableKeyboard():h.disableKeyboard()},inertialDragging(t){const{map:h}=this;t?h.enableInertialDragging():h.disableInertialDragging()},continuousZoom(t){const{map:h}=this;t?h.enableContinuousZoom():h.disableContinuousZoom()},pinchToZoom(t){const{map:h}=this;t?h.enablePinchToZoom():h.disablePinchToZoom()},autoResize(t){const{map:h}=this;t?h.enableAutoResize():h.disableAutoResize()},theme(t){const{map:h}=this;h[W("setMapStyle")]({styleJson:t})},mapStyle:{handler(t){const{map:h,theme:o}=this;!o&&h[W("setMapStyle")](t)},deep:!0}},methods:{setMapOptions(){const{map:t,minZoom:h,maxZoom:o,mapType:u,dragging:v,scrollWheelZoom:m,doubleClickZoom:e,keyboard:s,inertialDragging:i,continuousZoom:n,pinchToZoom:p,autoResize:c}=this;h&&t.setMinZoom(h),o&&t.setMaxZoom(o),u&&t.setMapType(window[u]),v?t.enableDragging():t.disableDragging(),m?t.enableScrollWheelZoom():t.disableScrollWheelZoom(),e?t.enableDoubleClickZoom():t.disableDoubleClickZoom(),s?t.enableKeyboard():t.disableKeyboard(),i?t.enableInertialDragging():t.disableInertialDragging(),n?t.enableContinuousZoom():t.disableContinuousZoom(),p?t.enablePinchToZoom():t.disablePinchToZoom(),c?t.enableAutoResize():t.disableAutoResize()},init(t){if(this.map)return;let h=this.$refs.view;this.$slots.default;const o=new t.Map(h,{enableHighResolution:this.highResolution,enableMapClick:this.mapClick});this.map=o;const{setMapOptions:u,zoom:v,getCenterPoint:m,theme:e,mapStyle:s}=this;u(),J.call(this,o),o.reset(),this.setCenterZoom(o,m(),v),e?o[W("setMapStyle")]({styleJson:e}):s&&o[W("setMapStyle")](s);let i=0;this.$emit("init",{BMap:t,map:o}),D.$emit("init",{BMap:t,map:o}),o.addEventListener("tilesloaded",()=>{i||(i++,this.$emit("ready",{BMap:t,map:o}),D.$emit("ready",{BMap:t,map:o}))}),o.addEventListener("loaded",()=>{this.$emit("loaded",{BMap:t,map:o}),D.$emit("loaded",{BMap:t,map:o})})},setCenterZoom(t,h,o){L().type==="WebGL"&&(!this.hasAnimation||!this.defaultAnimation)?t.setCenter(h,{noAnimation:!this.hasAnimation,callback:()=>{t.setZoom(o,{noAnimation:!this.hasAnimation,zoomCenter:h,callback:()=>{this.$emit("animationed",{BMap:this.BMap,map:t})}})}}):t.centerAndZoom(h,o)},getCenterPoint(){const{center:t,BMap:h}=this;switch(it(t)){case"String":return t;case"Object":return new h.Point(t.lng,t.lat);default:return new h.Point}},initMap(t){this.BMap=t,this.init(t)},getMapScript(){return window.BMap?window.BMap._preloader?window.BMap._preloader:Promise.resolve(window.BMap):(window.BMap={},window.BMap._preloader=new Promise((t,h)=>{window._initBaiduMap=function(){window.BMap=L().type=="WebGL"?window.BMapGL:window.BMap,t(window.BMap),window.document.body.removeChild(o),window.BMap._preloader=null,window._initBaiduMap=null};const o=document.createElement("script");switch(window.document.body.appendChild(o),L().type){case"WebGL":o.src=`https://api.map.baidu.com/api?v=1.0&type=webgl&ak=${L().ak}&callback=_initBaiduMap`;break;default:o.src=`https://api.map.baidu.com/api?v=${L().v}&ak=${L().ak}&callback=_initBaiduMap`}}),window.BMap._preloader)},reset(){const{getMapScript:t,initMap:h}=this;t().then(h)}},created(){const t={};this.ak&&(t.ak=this.ak),this.v&&(t.v=this.v),this.type&&(t.type=this.type),Et(t)},mounted(){this.reset()},data(){return{hasBmView:!1,map:null,BMap:null,name:"bm-map"}}},zt={key:0,ref:"view",style:{width:"100%",height:"100%"}};function Lt(t,h,o,u,v,m){return j(),Y("div",{class:ut(t.$attrs.class),style:ft(t.$attrs.style)},[v.hasBmView?ot("",!0):(j(),Y("div",zt,null,512)),at(t.$slots,"default")],6)}var $t=rt(At,[["render",Lt]]);const Dt={control:{unload:"removeControl"},layer:{unload:"removeTileLayer"},overlay:{unload:"removeOverlay"},contextMenu:{unload:"removeContextMenu"}},U=t=>t.abstract||t.name!=="bm-map"?U(t.$parent):t;function Ft(){const{unload:t,renderByParent:h,$parent:o,ready:u}=this;D.$off("ready",u),h&&o.reload(),t()}const Zt=(t={})=>({emits:["ready"],computed:{renderByParent(){return this.$parent.preventChildrenRender}},created(){const o=U(this.$parent).map,{ready:u}=this;o?u():D.$on("ready",u),D.$on("init",this.init)},mounted(){const o=U(this.$parent).map,{mountedReady:u}=this;o?u():D.$on("ready",u)},unmounted:Ft,methods:{init(){},ready(){const h=U(this.$parent),o=this.BMap=h.BMap,u=this.map=h.map;this.load(),this.$emit("ready",{BMap:o,map:u})},mountedReady(){this.mountedLoad()},transmitEvent(h){this.$emit(h.type.replace(/^on/,""),h)},reload(){this&&this.BMap&&this.$nextTick(()=>{this.unload(),this.$nextTick(()=>{this.load(),this.mountedLoad()})})},unload(){const{map:h,originInstance:o}=this;try{switch(t.type){case"search":return o.clearResults();case"autoComplete":case"lushu":return o.dispose();case"markerClusterer":return o.clearMarkers();default:h[Dt[t.type].unload](o)}}catch{}},mountedLoad(){}}});var G=t=>Zt({type:t});const Rt={name:"bm-navigation",render(){},mixins:[G("control")],props:{anchor:{type:String},offset:{type:Object},type:{type:String},showZoomInfo:{type:Boolean},enableGeolocation:{type:Boolean,default:!1}},watch:{anchor(){this.reload()},offset(){this.reload()},type(){this.reload()},showZoomInfo(){this.reload()}},methods:{load(){const{BMap:t,map:h,anchor:o,offset:u,type:v,showZoomInfo:m,enableGeolocation:e}=this;let s={anchor:window[o],offset:u&&O(t,u),type:window[v],showZoomInfo:m,enableGeolocation:e};R(s),this.originInstance=new t[W("NavigationControl")](s),h.addControl(this.originInstance)}}},Nt={name:"bm-geolocation",render(){},mixins:[G("control")],props:{anchor:{type:String},offset:{type:Object},showAddressBar:{type:Boolean},autoLocation:{type:Boolean},locationIcon:{type:Object}},watch:{anchor(){this.reload()},offset(){this.reload()},showAddressBar(){this.reload()},autoLocation(){this.reload()},locationIcon(){this.reload()}},methods:{load(){const{BMap:t,map:h,anchor:o,showAddressBar:u,autoLocation:v,locationIcon:m,offset:e}=this;let s={anchor:window[o],showAddressBar:u,enableAutoLocation:v,offset:e&&O(t,e),locationIcon:m&&K(t,m)};switch(R(s),L().type){case"WebGL":this.originInstance=new t.LocationControl(s);break;default:this.originInstance=new t.GeolocationControl(s)}J.call(this,this.originInstance),h.addControl(this.originInstance)}}},Wt={name:"bm-city-list",render(){},emits:["changeBefore","changeAfter"],mixins:[G("control")],props:{anchor:{type:String},offset:{type:Object}},watch:{anchor(){this.reload()},offset(){this.reload()}},methods:{load(){const{BMap:t,map:h,anchor:o,offset:u}=this,v=this;this.originInstance=new t.CityListControl({anchor:window[o],offset:u&&O(t,u),onChangeBefore(){v.$emit("changeBefore")},onChangeAfter(){v.$emit("changeAfter")}}),h.addControl(this.originInstance)}}},jt={name:"bm-marker",mixins:[G("overlay")],inject:["Cluster"],props:{position:{},offset:{},icon:{},massClear:{type:Boolean,default:!0},dragging:{type:Boolean,default:!1},clicking:{type:Boolean,default:!0},raiseOnDrag:{type:Boolean,default:!1},draggingCursor:{type:String},rotation:{type:Number},shadow:{type:Object},title:{type:String},label:{type:Object},animation:{type:String},top:{type:Boolean,default:!1},zIndex:{type:Number,default:0}},watch:{"position.lng"(t,h){const{BMap:o,originInstance:u,position:v,renderByParent:m,$parent:e}=this;t!==h&&t>=-180&&t<=180&&u.setPosition(F(o,{lng:t,lat:v.lat})),m&&e.reload()},"position.lat"(t,h){const{BMap:o,originInstance:u,position:v,renderByParent:m,$parent:e}=this;t!==h&&t>=-74&&t<=74&&u.setPosition(F(o,{lng:v.lng,lat:t})),m&&e.reload()},"offset.width"(t,h){const{BMap:o,originInstance:u}=this;t!==h&&u.setOffset(new o.Size(t,this.offset.height))},"offset.height"(t,h){const{BMap:o,originInstance:u}=this;t!==h&&u.setOffset(new o.Size(this.offset.width,t))},icon:{deep:!0,handler(t){const{BMap:h,originInstance:o,rotation:u}=this;o&&o.setIcon(K(h,t)),u&&o&&o.setRotation(u)}},massClear(t){t?this.originInstance.enableMassClear():this.originInstance.disableMassClear()},dragging(t){t?this.originInstance.enableDragging():this.originInstance.disableDragging()},clicking(){this.reload()},raiseOnDrag(){this.reload()},draggingCursor(t){this.originInstance.setDraggingCursor(t)},rotation(t){this.originInstance.setRotation(t)},shadow(t){this.originInstance.setShadow(t)},title(t){this.originInstance.setTitle(t)},label(t){this.reload()},animation(t){this.originInstance.setAnimation(window[t])},top(t){this.originInstance.setTop(t)},zIndex(t){this.originInstance.setZIndex(t)}},methods:{load(){var t;const{BMap:h,map:o,position:u,offset:v,icon:m,massClear:e,dragging:s,clicking:i,raiseOnDrag:n,draggingCursor:p,rotation:c,shadow:f,title:a,label:d,animation:_,top:b,renderByParent:l,$parent:M,zIndex:S}=this;let P={offset:v,icon:m&&K(h,m),enableMassClear:e,enableDragging:s,enableClicking:i,raiseOnDrag:n,draggingCursor:p,rotation:c,shadow:f,title:a};R(P);const C=new h.Marker(new h.Point(u.lng,u.lat),P);this.originInstance=C,d&&C&&C.setLabel(Pt(h,d)),C.setTop(b),C.setZIndex(S),J.call(this,C),l?M.reload():o.addOverlay(C),C.setAnimation(window[_]),(t=this.Cluster)==null||t.addMaker(this)}},beforeUnmount(){var t;(t=this.Cluster)==null||t.removeMaker(this)}};function Gt(t,h,o,u,v,m){return j(),Y("div",null,[at(t.$slots,"default")])}var Ht=rt(jt,[["render",Gt]]);const Vt={name:"bm-label",render(){},mixins:[G("overlay")],props:{content:{type:String},title:{type:String},offset:{},position:{},labelStyle:{},zIndex:{type:Number,default:0},massClear:{type:Boolean,default:!0}},watch:{content(t){this.originInstance.setContent(t)},title(t){this.originInstance.setTitle(t)},"offset.width"(t,h){const{BMap:o}=this;t.toString()!==h.toString()&&this.originInstance.setOffset(O(o,{width:t,height:this.offset.height}))},"offset.height"(t,h){const{BMap:o}=this;t.toString()!==h.toString()&&this.originInstance.setOffset(O(o,{width:this.offset.width,height:t}))},"position.lng"(t,h){const{BMap:o}=this,u=t;t.toString()!==h.toString()&&u>=-180&&u<=180&&this.originInstance.setPosition(F(o,{lng:u,lat:this.position.lat}))},"position.lat"(t,h){const{BMap:o}=this,u=t;t.toString()!==h.toString()&&u>=-74&&u<=74&&this.originInstance.setPosition(F(o,{lng:this.position.lng,lat:u}))},labelStyle:{handler(t){this.originInstance.setStyle(t)},deep:!0},zIndex(t){this.originInstance.setZIndex(t)},massClear(t){t?this.originInstance.enableMassClear():this.originInstance.disableMassClear()}},methods:{load(){const{BMap:t,map:h,content:o,title:u,offset:v,position:m,labelStyle:e,zIndex:s,massClear:i,$parent:n}=this;let p={offset:O(t,v),position:F(t,m),enableMassClear:i};R(p);const c=new t.Label(o,p);this.originInstance=c;try{n.originInstance.setLabel(c)}catch{h.addOverlay(c)}u&&c.setTitle(u),e&&c.setStyle(e),s&&c.setZIndex(s),J.call(this,c)}}};var lt={exports:{}};(function(t,h){(function(o,u){t.exports=u()})(Z,function(){var o=typeof window!="undefined"?window:typeof Z!="undefined"?Z:this;function u(a,d){return d={exports:{}},a(d,d.exports,o),d.exports}var v=u(function(a,d,_){(function(b,l){typeof d=="object"?a.exports=l():(b.BMapLib=b.BMapLib||{},b.BMapLib.TextIconOverlay=b.BMapLib.TextIconOverlay||l())})(o,function(){var b,l=b=l||{version:"1.3.8"},M={};l.guid="$BAIDU$",M[l.guid]=M[l.guid]||{},l.dom=l.dom||{},l.dom.g=function(r){return typeof r=="string"||r instanceof String?document.getElementById(r):r&&r.nodeName&&(r.nodeType==1||r.nodeType==9)?r:null},l.g=l.G=l.dom.g,l.dom.getDocument=function(r){return r=l.dom.g(r),r.nodeType==9?r:r.ownerDocument||r.document},l.lang=l.lang||{},l.lang.isString=function(r){return Object.prototype.toString.call(r)=="[object String]"},l.isString=l.lang.isString,l.dom._g=function(r){return l.lang.isString(r)?document.getElementById(r):r},l._g=l.dom._g,l.browser=l.browser||{},/msie (\d+\.\d)/i.test(navigator.userAgent)&&(l.browser.ie=l.ie=document.documentMode||+RegExp.$1),l.dom.getComputedStyle=function(r,g){r=l.dom._g(r);var y=l.dom.getDocument(r),w;return y.defaultView&&y.defaultView.getComputedStyle&&(w=y.defaultView.getComputedStyle(r,null),w)?w[g]||w.getPropertyValue(g):""},l.dom._styleFixer=l.dom._styleFixer||{},l.dom._styleFilter=l.dom._styleFilter||[],l.dom._styleFilter.filter=function(r,g,y){for(var w=0,x=l.dom._styleFilter,I;I=x[w];w++)(I=I[y])&&(g=I(r,g));return g},l.string=l.string||{},l.string.toCamelCase=function(r){return r.indexOf("-")<0&&r.indexOf("_")<0?r:r.replace(/[-_][^-_]/g,function(g){return g.charAt(1).toUpperCase()})},l.dom.getStyle=function(r,g){var y=l.dom;r=y.g(r),g=l.string.toCamelCase(g);var w=r.style[g]||(r.currentStyle?r.currentStyle[g]:"")||y.getComputedStyle(r,g);if(!w){var x=y._styleFixer[g];x&&(w=x.get?x.get(r):l.dom.getStyle(r,x))}return(x=y._styleFilter)&&(w=x.filter(g,w,"get")),w},l.getStyle=l.dom.getStyle,/opera\/(\d+\.\d)/i.test(navigator.userAgent)&&(l.browser.opera=+RegExp.$1),l.browser.isWebkit=/webkit/i.test(navigator.userAgent),l.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent),l.browser.isStrict=document.compatMode=="CSS1Compat",l.dom.getPosition=function(r){r=l.dom.g(r);var g=l.dom.getDocument(r),y=l.browser,w=l.dom.getStyle;y.isGecko>0&&g.getBoxObjectFor&&w(r,"position")=="absolute"&&(r.style.top===""||r.style.left);var x={left:0,top:0},I=y.ie&&!y.isStrict?g.body:g.documentElement,B,k;if(r==I)return x;if(r.getBoundingClientRect){k=r.getBoundingClientRect(),x.left=Math.floor(k.left)+Math.max(g.documentElement.scrollLeft,g.body.scrollLeft),x.top=Math.floor(k.top)+Math.max(g.documentElement.scrollTop,g.body.scrollTop),x.left-=g.documentElement.clientLeft,x.top-=g.documentElement.clientTop;var T=g.body,N=parseInt(w(T,"borderLeftWidth")),et=parseInt(w(T,"borderTopWidth"));y.ie&&!y.isStrict&&(x.left-=isNaN(N)?2:N,x.top-=isNaN(et)?2:et)}else{B=r;do{if(x.left+=B.offsetLeft,x.top+=B.offsetTop,y.isWebkit>0&&w(B,"position")=="fixed"){x.left+=g.body.scrollLeft,x.top+=g.body.scrollTop;break}B=B.offsetParent}while(B&&B!=r);for((y.opera>0||y.isWebkit>0&&w(r,"position")=="absolute")&&(x.top-=g.body.offsetTop),B=r.offsetParent;B&&B!=g.body;)x.left-=B.scrollLeft,(!y.opera||B.tagName!="TR")&&(x.top-=B.scrollTop),B=B.offsetParent}return x},l.event=l.event||{},l.event._listeners=l.event._listeners||[],l.event.on=function(r,g,y){g=g.replace(/^on/i,""),r=l.dom._g(r);var w=function(T){y.call(r,T)},x=l.event._listeners,I=l.event._eventFilter,B,k=g;return g=g.toLowerCase(),I&&I[g]&&(B=I[g](r,g,w),k=B.type,w=B.listener),r.addEventListener?r.addEventListener(k,w,!1):r.attachEvent&&r.attachEvent("on"+k,w),x[x.length]=[r,g,y,w,k],r},l.on=l.event.on,function(){var r=M[l.guid];l.lang.guid=function(){return"TANGRAM__"+(r._counter++).toString(36)},r._counter=r._counter||1}(),M[l.guid]._instances=M[l.guid]._instances||{},l.lang.isFunction=function(r){return Object.prototype.toString.call(r)=="[object Function]"},l.lang.Class=function(r){this.guid=r||l.lang.guid(),M[l.guid]._instances[this.guid]=this},M[l.guid]._instances=M[l.guid]._instances||{},l.lang.Class.prototype.dispose=function(){delete M[l.guid]._instances[this.guid];for(var r in this)l.lang.isFunction(this[r])||delete this[r];this.disposed=!0},l.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},l.lang.Event=function(r,g){this.type=r,this.returnValue=!0,this.target=g||null,this.currentTarget=null},l.lang.Class.prototype.addEventListener=function(r,g,y){if(!!l.lang.isFunction(g)){!this.__listeners&&(this.__listeners={});var w=this.__listeners,x;if(typeof y=="string"&&y){if(/[^\w\-]/.test(y))throw"nonstandard key:"+y;g.hashCode=y,x=y}r.indexOf("on")!=0&&(r="on"+r),typeof w[r]!="object"&&(w[r]={}),x=x||l.lang.guid(),g.hashCode=x,w[r][x]=g}},l.lang.Class.prototype.removeEventListener=function(r,g){if(!(typeof g!="undefined"&&(l.lang.isFunction(g)&&!(g=g.hashCode)||!l.lang.isString(g)))){!this.__listeners&&(this.__listeners={}),r.indexOf("on")!=0&&(r="on"+r);var y=this.__listeners;if(!!y[r])if(typeof g!="undefined")y[r][g]&&delete y[r][g];else for(var w in y[r])delete y[r][w]}},l.lang.Class.prototype.dispatchEvent=function(r,g){l.lang.isString(r)&&(r=new l.lang.Event(r)),!this.__listeners&&(this.__listeners={}),g=g||{};for(var y in g)r[y]=g[y];var y,w=this.__listeners,x=r.type;if(r.target=r.target||this,r.currentTarget=this,x.indexOf("on")!=0&&(x="on"+x),l.lang.isFunction(this[x])&&this[x].apply(this,arguments),typeof w[x]=="object")for(y in w[x])w[x][y].apply(this,arguments);return r.returnValue},l.lang.inherits=function(r,g,y){var w,x,I=r.prototype,B=new Function;B.prototype=g.prototype,x=r.prototype=new B;for(w in I)x[w]=I[w];r.prototype.constructor=r,r.superClass=g.prototype,typeof y=="string"&&(x._className=y)},l.inherits=l.lang.inherits;var S="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/images/m",P="png",C=function(r,g,y){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}b.lang.inherits(C,BMap.Overlay,"TextIconOverlay"),this._position=r,this._text=g,this._options=y||{},this._styles=this._options.styles||[],!this._styles.length&&this._setupDefaultStyles()};return C.prototype._setupDefaultStyles=function(){for(var r=[53,56,66,78,90],g=0,y;y=r[g];g++)this._styles.push({url:S+g+"."+P,size:new BMap.Size(y,y)})},C.prototype.initialize=function(r){return this._map=r,this._domElement=document.createElement("div"),this._updateCss(),this._updateText(),this._updatePosition(),this._bind(),this._map.getPanes().markerMouseTarget.appendChild(this._domElement),this._domElement},C.prototype.draw=function(){this._map&&this._updatePosition()},C.prototype.getText=function(){return this._text},C.prototype.setText=function(r){r&&(!this._text||this._text.toString()!=r.toString())&&(this._text=r,this._updateText(),this._updateCss(),this._updatePosition())},C.prototype.getPosition=function(){return this._position},C.prototype.setPosition=function(r){r&&(!this._position||!this._position.equals(r))&&(this._position=r,this._updatePosition())},C.prototype.getStyleByText=function(r,g){var y=parseInt(r),w=parseInt(y/10);return w=Math.max(0,w),w=Math.min(w,g.length-1),g[w]},C.prototype._updateCss=function(){if(!!this._domElement){var r=this.getStyleByText(this._text,this._styles);this._domElement.style.cssText=this._buildCssText(r)}},C.prototype._updateText=function(){this._domElement&&(this._domElement.innerHTML=this._text)},C.prototype._updatePosition=function(){if(this._domElement&&this._position){var r=this._domElement.style,g=this._map.pointToOverlayPixel(this._position);g.x-=Math.ceil(parseInt(r.width)/2),g.y-=Math.ceil(parseInt(r.height)/2),r.left=g.x+"px",r.top=g.y+"px"}},C.prototype._buildCssText=function(r){var g=r.url,y=r.size,w=r.anchor,x=r.offset,I=r.textColor||"black",B=r.textSize||10,k=[];if(b.browser.ie<7)k.push('filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="'+g+'");');else{k.push("background-image:url("+g+");");var T="0 0";x instanceof BMap.Size&&(T=x.width+"px "+x.height+"px"),k.push("background-position:"+T+";")}return y instanceof BMap.Size&&(w instanceof BMap.Size?(w.height>0&&w.height<y.height&&k.push("height:"+(y.height-w.height)+"px; padding-top:"+w.height+"px;"),w.width>0&&w.width<y.width&&k.push("width:"+(y.width-w.width)+"px; padding-left:"+w.width+"px;")):(k.push("height:"+y.height+"px; line-height:"+y.height+"px;"),k.push("width:"+y.width+"px; text-align:center;"))),k.push("cursor:pointer; color:"+I+"; position:absolute; font-size:"+B+"px; font-family:Arial,sans-serif; font-weight:bold"),k.join("")},C.prototype._bind=function(){if(!this._domElement)return;var r=this,g=this._map,y=b.lang.Event;function w(x,I){var B=x.srcElement||x.target,k=x.clientX||x.pageX,T=x.clientY||x.pageY;if(x&&I&&k&&T&&B){var N=b.dom.getPosition(g.getContainer());I.pixel=new BMap.Pixel(k-N.left,T-N.top),I.point=g.pixelToPoint(I.pixel)}return I}b.event.on(this._domElement,"mouseover",function(x){r.dispatchEvent(w(x,new y("onmouseover")))}),b.event.on(this._domElement,"mouseout",function(x){r.dispatchEvent(w(x,new y("onmouseout")))}),b.event.on(this._domElement,"click",function(x){r.dispatchEvent(w(x,new y("onclick")))})},C})}),m=v&&typeof v=="object"&&"default"in v?v.default:v,e=function(a,d,_){d=s(d);var b=a.pointToPixel(d.getNorthEast()),l=a.pointToPixel(d.getSouthWest());b.x+=_,b.y-=_,l.x-=_,l.y+=_;var M=a.pixelToPoint(b),S=a.pixelToPoint(l);return new BMap.Bounds(S,M)},s=function(a){var d=i(a.getNorthEast().lng,-180,180),_=i(a.getSouthWest().lng,-180,180),b=i(a.getNorthEast().lat,-74,74),l=i(a.getSouthWest().lat,-74,74);return new BMap.Bounds(new BMap.Point(_,l),new BMap.Point(d,b))},i=function(a,d,_){return d&&(a=Math.max(a,d)),_&&(a=Math.min(a,_)),a},n=function(a){return Object.prototype.toString.call(a)==="[object Array]"},p=function(a,d){var _=-1;if(n(d)){if(d.indexOf)_=d.indexOf(a);else for(var b=0,l;l=d[b];b++)if(l===a){_=b;break}}return _},c=function(a,d){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}if(!!a){this._map=a,this._markers=[],this._clusters=[];var _=d||{};this._gridSize=_.gridSize||60,this._maxZoom=_.maxZoom||18,this._minClusterSize=_.minClusterSize||2,this._isAverageCenter=!1,_.isAverageCenter!=null&&(this._isAverageCenter=_.isAverageCenter),this._styles=_.styles||[];var b=this;this._map.addEventListener("zoomend",function(){b._redraw()}),this._map.addEventListener("moveend",function(){b._redraw()});var l=_.markers;n(l)&&this.addMarkers(l)}};c.prototype.addMarkers=function(a){if(!!a.length){for(var d=0,_=a.length;d<_;d++)this._pushMarkerTo(a[d]);this._createClusters()}},c.prototype._pushMarkerTo=function(a){var d=p(a,this._markers);d===-1&&(a.isInCluster=!1,this._markers.push(a))},c.prototype.addMarker=function(a){this._pushMarkerTo(a),this._createClusters()},c.prototype._createClusters=function(){var a=this._map.getBounds();if(!!a.getCenter())for(var d=e(this._map,a,this._gridSize),_=0,b;b=this._markers[_];_++)!b.isInCluster&&d.containsPoint(b.getPosition())&&this._addToClosestCluster(b)},c.prototype._addToClosestCluster=function(a){var d=4e6,_=null;a.getPosition();for(var b=0,l;l=this._clusters[b];b++){var M=l.getCenter();if(M){var S=this._map.getDistance(M,a.getPosition());S<d&&(d=S,_=l)}}if(_&&_.isMarkerInClusterBounds(a))_.addMarker(a);else{var l=new f(this);l.addMarker(a),this._clusters.push(l)}},c.prototype._clearLastClusters=function(){for(var a=0,d;d=this._clusters[a];a++)d.remove();this._clusters=[],this._removeMarkersFromCluster()},c.prototype._removeMarkersFromCluster=function(){for(var a=0,d;d=this._markers[a];a++)d.isInCluster=!1},c.prototype._removeMarkersFromMap=function(){for(var a=0,d;d=this._markers[a];a++){d.isInCluster=!1;var _=d.getLabel();this._map.removeOverlay(d),d.setLabel(_)}},c.prototype._removeMarker=function(a){var d=p(a,this._markers);return d===-1?!1:(this._map.removeOverlay(a),this._markers.splice(d,1),!0)},c.prototype.removeMarker=function(a){var d=this._removeMarker(a);return d&&(this._clearLastClusters(),this._createClusters()),d},c.prototype.removeMarkers=function(a){for(var d=!1,_=0;_<a.length;_++){var b=this._removeMarker(a[_]);d=d||b}return d&&(this._clearLastClusters(),this._createClusters()),d},c.prototype.clearMarkers=function(){this._clearLastClusters(),this._removeMarkersFromMap(),this._markers=[]},c.prototype._redraw=function(){this._clearLastClusters(),this._createClusters()},c.prototype.getGridSize=function(){return this._gridSize},c.prototype.setGridSize=function(a){this._gridSize=a,this._redraw()},c.prototype.getMaxZoom=function(){return this._maxZoom},c.prototype.setMaxZoom=function(a){this._maxZoom=a,this._redraw()},c.prototype.getStyles=function(){return this._styles},c.prototype.setStyles=function(a){this._styles=a,this._redraw()},c.prototype.getMinClusterSize=function(){return this._minClusterSize},c.prototype.setMinClusterSize=function(a){this._minClusterSize=a,this._redraw()},c.prototype.isAverageCenter=function(){return this._isAverageCenter},c.prototype.getMap=function(){return this._map},c.prototype.getMarkers=function(){return this._markers},c.prototype.getClustersCount=function(){for(var a=0,d=0,_;_=this._clusters[d];d++)_.isReal()&&a++;return a};function f(a){this._markerClusterer=a,this._map=a.getMap(),this._minClusterSize=a.getMinClusterSize(),this._isAverageCenter=a.isAverageCenter(),this._center=null,this._markers=[],this._gridBounds=null,this._isReal=!1,this._clusterMarker=new m(this._center,this._markers.length,{styles:this._markerClusterer.getStyles()})}return f.prototype.addMarker=function(a){if(this.isMarkerInCluster(a))return!1;if(!this._center)this._center=a.getPosition(),this.updateGridBounds();else if(this._isAverageCenter){var d=this._markers.length+1,_=(this._center.lat*(d-1)+a.getPosition().lat)/d,b=(this._center.lng*(d-1)+a.getPosition().lng)/d;this._center=new BMap.Point(b,_),this.updateGridBounds()}a.isInCluster=!0,this._markers.push(a);var l=this._markers.length;if(l<this._minClusterSize)return this._map.addOverlay(a),!0;if(l===this._minClusterSize)for(var M=0;M<l;M++){var S=this._markers[M].getLabel();this._markers[M].getMap()&&this._map.removeOverlay(this._markers[M]),this._markers[M].setLabel(S)}return this._map.addOverlay(this._clusterMarker),this._isReal=!0,this.updateClusterMarker(),!0},f.prototype.isMarkerInCluster=function(a){if(this._markers.indexOf)return this._markers.indexOf(a)!=-1;for(var d=0,_;_=this._markers[d];d++)if(_===a)return!0;return!1},f.prototype.isMarkerInClusterBounds=function(a){return this._gridBounds.containsPoint(a.getPosition())},f.prototype.isReal=function(a){return this._isReal},f.prototype.updateGridBounds=function(){var a=new BMap.Bounds(this._center,this._center);this._gridBounds=e(this._map,a,this._markerClusterer.getGridSize())},f.prototype.updateClusterMarker=function(){if(this._map.getZoom()>this._markerClusterer.getMaxZoom()){this._clusterMarker&&this._map.removeOverlay(this._clusterMarker);for(var a=0,d;d=this._markers[a];a++)this._map.addOverlay(d);return}if(this._markers.length<this._minClusterSize){this._clusterMarker.hide();return}this._clusterMarker.setPosition(this._center),this._clusterMarker.setText(this._markers.length),this._clusterMarker.addEventListener&&!this._clusterMarker._hasClickEvent&&this._clusterMarker.addEventListener("click",function(_){this._clusterMarker._hasClickEvent=!0,this._markers&&this._map.setViewport(this.getBounds())}.bind(this))},f.prototype.remove=function(){for(var a=0;this._markers[a];a++){var d=this._markers[a].getLabel();this._markers[a].getMap()&&this._map.removeOverlay(this._markers[a]),this._markers[a].setLabel(d)}this._map.removeOverlay(this._clusterMarker),this._markers.length=0,delete this._markers},f.prototype.getBounds=function(){for(var a=new BMap.Bounds(this._center,this._center),d=0,_;_=this._markers[d];d++)a.extend(_.getPosition());return a},f.prototype.getCenter=function(){return this._center},c})})(lt);lt.exports;var ht={exports:{}};(function(t,h){(function(o,u){t.exports=u()})(Z,function(){var o={};o.dom={},o.dom.g=function(e){return typeof e=="string"||e instanceof String?document.getElementById(e):e&&e.nodeName&&(e.nodeType==1||e.nodeType==9)?e:null},o.g=o.G=o.dom.g,o.lang=o.lang||{},o.lang.isString=function(e){return Object.prototype.toString.call(e)=="[object String]"},o.isString=o.lang.isString,o.dom._g=function(e){return o.lang.isString(e)?document.getElementById(e):e},o._g=o.dom._g,o.dom.getDocument=function(e){return e=o.dom.g(e),e.nodeType==9?e:e.ownerDocument||e.document},o.browser=o.browser||{},o.browser.ie=o.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0,o.dom.getComputedStyle=function(e,s){e=o.dom._g(e);var i=o.dom.getDocument(e),n;return i.defaultView&&i.defaultView.getComputedStyle&&(n=i.defaultView.getComputedStyle(e,null),n)?n[s]||n.getPropertyValue(s):""},o.dom._styleFixer=o.dom._styleFixer||{},o.dom._styleFilter=o.dom._styleFilter||[],o.dom._styleFilter.filter=function(e,s,i){for(var n=0,p=o.dom._styleFilter,c;c=p[n];n++)(c=c[i])&&(s=c(e,s));return s},o.string=o.string||{},o.string.toCamelCase=function(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(s){return s.charAt(1).toUpperCase()})},o.dom.getStyle=function(e,s){var i=o.dom;e=i.g(e),s=o.string.toCamelCase(s);var n=e.style[s]||(e.currentStyle?e.currentStyle[s]:"")||i.getComputedStyle(e,s);if(!n){var p=i._styleFixer[s];p&&(n=p.get?p.get(e):o.dom.getStyle(e,p))}return(p=i._styleFilter)&&(n=p.filter(s,n,"get")),n},o.getStyle=o.dom.getStyle,o.dom._NAME_ATTRS=function(){var e={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};return o.browser.ie<8?(e.for="htmlFor",e.class="className"):(e.htmlFor="for",e.className="class"),e}(),o.dom.setAttr=function(e,s,i){return e=o.dom.g(e),s=="style"?e.style.cssText=i:(s=o.dom._NAME_ATTRS[s]||s,e.setAttribute(s,i)),e},o.setAttr=o.dom.setAttr,o.dom.setAttrs=function(e,s){e=o.dom.g(e);for(var i in s)o.dom.setAttr(e,i,s[i]);return e},o.setAttrs=o.dom.setAttrs,o.dom.create=function(e,s){var i=document.createElement(e),n=s||{};return o.dom.setAttrs(i,n)},o.object=o.object||{},o.extend=o.object.extend=function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i]);return e};var u=function(e,s,i){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}!s||s.length<1||(this._map=e,this._path=s,this.i=0,this._setTimeoutQuene=[],this._projection=this._map.getMapType().getProjection(),this._opts={icon:null,speed:4e3,defaultContent:"",showInfoWindow:!1},this._setOptions(i),this._rotation=0,!this._opts.icon instanceof BMap.Icon&&(this._opts.icon=defaultIcon))};u.prototype._setOptions=function(e){if(!!e)for(var s in e)e.hasOwnProperty(s)&&(this._opts[s]=e[s])},u.prototype.start=function(){var e=this,s=e._path.length;if(this._opts.onstart&&this._opts.onstart(e),e.i&&e.i<s-1)if(e._fromPause)e._fromStop||e._moveNext(++e.i);else return;else!e._marker&&e._addMarker(),e._timeoutFlag=setTimeout(function(){!e._overlay&&e._addInfoWin(),e._moveNext(e.i)},400);this._fromPause=!1,this._fromStop=!1},u.prototype.stop=function(){this.i=0,this._fromStop=!0,clearInterval(this._intervalFlag),this._clearTimeout();for(var e=0,s=this._opts.landmarkPois,i=s.length;e<i;e++)s[e].bShow=!1;this._opts.onstop&&this._opts.onstop(this)},u.prototype.pause=function(){clearInterval(this._intervalFlag),this._fromPause=!0,this._clearTimeout(),this._opts.onpause&&this._opts.onpause(this)},u.prototype.hideInfoWindow=function(){this._opts.showInfoWindow=!1,this._overlay&&(this._overlay._div.style.visibility="hidden")},u.prototype.showInfoWindow=function(){this._opts.showInfoWindow=!0,this._overlay&&(this._overlay._div.style.visibility="visible")},u.prototype.dispose=function(){clearInterval(this._intervalFlag),this._setTimeoutQuene&&this._clearTimeout(),this._map&&(this._map.removeOverlay(this._overlay),this._map.removeOverlay(this._marker))},o.object.extend(u.prototype,{_addMarker:function(e){this._marker&&(this.stop(),this._map.removeOverlay(this._marker),clearTimeout(this._timeoutFlag)),this._overlay&&this._map.removeOverlay(this._overlay);var s=new BMap.Marker(this._path[0]);this._opts.icon&&s.setIcon(this._opts.icon),this._map.addOverlay(s),s.setAnimation(BMAP_ANIMATION_DROP),this._marker=s},_addInfoWin:function(){var e=this;!v.prototype.initialize&&m();var s=new v(e._marker.getPosition(),e._opts.defaultContent);s.setRelatedClass(this),this._overlay=s,this._map.addOverlay(s),this._opts.showInfoWindow?this.showInfoWindow():this.hideInfoWindow()},_getMercator:function(e){return this._map.getMapType().getProjection().lngLatToPoint(e)},_getDistance:function(e,s){return Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))},_move:function(e,s,i){var n=this,p=0,c=10,f=this._opts.speed/(1e3/c),a=this._projection.lngLatToPoint(e),d=this._projection.lngLatToPoint(s),_=Math.round(n._getDistance(a,d)/f);if(_<1){n._moveNext(++n.i);return}n._intervalFlag=setInterval(function(){if(p>=_){if(clearInterval(n._intervalFlag),n.i>n._path.length)return;n._moveNext(++n.i)}else{p++;var b=i(a.x,d.x,p,_),l=i(a.y,d.y,p,_),M=n._projection.pointToLngLat(new BMap.Pixel(b,l));if(p==1){var S=null;n.i-1>=0&&(S=n._path[n.i-1]),n._opts.enableRotation==!0&&n.setRotation(S,e,s),n._opts.autoView&&(n._map.getBounds().containsPoint(M)||n._map.setCenter(M))}n._marker.setPosition(M),n._setInfoWin(M)}},c)},setRotation:function(e,s,i){var n=this,p=0;if(s=n._map.pointToPixel(s),i=n._map.pointToPixel(i),i.x!=s.x){var c=(i.y-s.y)/(i.x-s.x),f=Math.atan(c);p=f*360/(2*Math.PI),i.x<s.x?p=-p+90+90:p=-p,n._marker.setRotation(-p)}else{var a=i.y-s.y,d=0;a>0?d=-1:d=1,n._marker.setRotation(-d*90)}},linePixellength:function(e,s){return Math.sqrt(Math.abs(e.x-s.x)*Math.abs(e.x-s.x)+Math.abs(e.y-s.y)*Math.abs(e.y-s.y))},pointToPoint:function(e,s){return Math.abs(e.x-s.x)*Math.abs(e.x-s.x)+Math.abs(e.y-s.y)*Math.abs(e.y-s.y)},_moveNext:function(e){var s=this;e<this._path.length-1?s._move(s._path[e],s._path[e+1],s._tween.linear):s.stop()},_setInfoWin:function(e){var s=this;s._overlay.setPosition(e,s._marker.getIcon().size);var i=s._troughPointIndex(e);i!=-1?(clearInterval(s._intervalFlag),s._overlay.setHtml(s._opts.landmarkPois[i].html),s._overlay.setPosition(e,s._marker.getIcon().size),s._pauseForView(i)):s._overlay.setHtml(s._opts.defaultContent)},_pauseForView:function(e){var s=this,i=setTimeout(function(){s._moveNext(++s.i)},s._opts.landmarkPois[e].pauseTime*1e3);s._setTimeoutQuene.push(i)},_clearTimeout:function(){for(var e in this._setTimeoutQuene)clearTimeout(this._setTimeoutQuene[e]);this._setTimeoutQuene.length=0},_tween:{linear:function(e,s,i,n){var p=e,c=s-e,f=i,a=n;return c*f/a+p}},_troughPointIndex:function(e){for(var s=this._opts.landmarkPois,i,n=0,p=s.length;n<p;n++)if(!s[n].bShow&&(i=this._map.getDistance(new BMap.Point(s[n].lng,s[n].lat),e),i<10))return s[n].bShow=!0,n;return-1}});function v(e,s){this._point=e,this._html=s}function m(){v.prototype=new BMap.Overlay,v.prototype.initialize=function(e){var s=this._div=o.dom.create("div",{style:"border:solid 1px #ccc;width:auto;min-width:50px;text-align:center;position:absolute;background:#fff;color:#000;font-size:12px;border-radius: 10px;padding:5px;white-space: nowrap;"});return s.innerHTML=this._html,e.getPanes().floatPane.appendChild(s),this._map=e,s},v.prototype.draw=function(){this.setPosition(this.lushuMain._marker.getPosition(),this.lushuMain._marker.getIcon().size)},o.object.extend(v.prototype,{setPosition:function(e,s){var i=this._map.pointToOverlayPixel(e),n=o.dom.getStyle(this._div,"width"),p=o.dom.getStyle(this._div,"height"),c=parseInt(this._div.clientWidth||n,10);parseInt(this._div.clientHeight||p,10),this._div.style.left=i.x-c/2+"px",this._div.style.bottom=-(i.y-s.height)+"px"},setHtml:function(e){this._div.innerHTML=e},setRelatedClass:function(e){this.lushuMain=e}})}return u})})(ht);ht.exports;var ct={exports:{}};(function(t,h){(function(o,u){t.exports=u()})(Z,function(){function o(m,e,s){var i,n,p=m.prototype,c=new Function;c.prototype=e.prototype,n=m.prototype=new c;for(i in p)n[i]=p[i];m.prototype.constructor=m,m.superClass=e.prototype,typeof s=="string"&&(n._className=s)}var u=function(){var m=function(n){var p={data:[],heatmap:n};this.max=1,this.get=function(c){return p[c]},this.set=function(c,f){p[c]=f}};m.prototype={addDataPoint:function(i,n){if(!(i<0||n<0)){var p=this,c=p.get("heatmap"),f=p.get("data");if(f[i]||(f[i]=[]),f[i][n]||(f[i][n]=0),f[i][n]+=arguments.length<3?1:arguments[2],p.set("data",f),p.max<f[i][n]){c.get("actx").clearRect(0,0,c.get("width"),c.get("height")),p.setDataSet({max:f[i][n],data:f},!0);return}c.drawAlpha(i,n,f[i][n],!0)}},setDataSet:function(i,n){var p=this,c=p.get("heatmap"),f=[],a=i.data,d=a.length;if(c.clear(),this.max=i.max,c.get("legend")&&c.get("legend").update(i.max),n!=null&&n){for(var _ in a)if(_!==void 0)for(var b in a[_])b!==void 0&&c.drawAlpha(_,b,a[_][b],!1)}else for(;d--;){var l=a[d];c.drawAlpha(l.x,l.y,l.count,!1),f[l.x]||(f[l.x]=[]),f[l.x][l.y]||(f[l.x][l.y]=0),f[l.x][l.y]=l.count}c.colorize(),this.set("data",a)},exportDataSet:function(){var i=this,n=i.get("data"),p=[];for(var c in n)if(c!==void 0)for(var f in n[c])f!==void 0&&p.push({x:parseInt(c,10),y:parseInt(f,10),count:n[c][f]});return{max:i.max,data:p}},generateRandomDataSet:function(i){var n=this.get("heatmap"),p=n.get("width"),c=n.get("height"),f={},a=Math.floor(Math.random()*1e3+1);f.max=a;for(var d=[];i--;)d.push({x:Math.floor(Math.random()*p+1),y:Math.floor(Math.random()*c+1),count:Math.floor(Math.random()*a+1)});f.data=d,this.setDataSet(f)}};var e=function(n){this.config=n;var p={element:null,labelsEl:null,gradientCfg:null,ctx:null};this.get=function(c){return p[c]},this.set=function(c,f){p[c]=f},this.init()};e.prototype={init:function(){var i=this,n=i.config,p=n.title||"Legend",c=n.position,f=n.offset||10;n.gradient;var a=document.createElement("ul"),d,_,b="";i.processGradientObject(),c.indexOf("t")>-1?b+="top:"+f+"px;":b+="bottom:"+f+"px;",c.indexOf("l")>-1?b+="left:"+f+"px;":b+="right:"+f+"px;",d=document.createElement("div"),d.style.cssText="border-radius:5px;position:absolute;"+b+"font-family:Helvetica; width:256px;z-index:10000000000; background:rgba(255,255,255,1);padding:10px;border:1px solid black;margin:0;",d.innerHTML="<h3 style='padding:0;margin:0;text-align:center;font-size:16px;'>"+p+"</h3>",a.style.cssText="position:relative;font-size:12px;display:block;list-style:none;list-style-type:none;margin:0;height:15px;",_=document.createElement("div"),_.style.cssText=["position:relative;display:block;width:256px;height:15px;border-bottom:1px solid black; background-image:url(",i.createGradientImage(),");"].join(""),d.appendChild(a),d.appendChild(_),i.set("element",d),i.set("labelsEl",a),i.update(1)},processGradientObject:function(){var i=this,n=this.config.gradient,p=[];for(var c in n)n.hasOwnProperty(c)&&p.push({stop:c,value:n[c]});p.sort(function(f,a){return f.stop-a.stop}),p.unshift({stop:0,value:"rgba(0,0,0,0)"}),i.set("gradientArr",p)},createGradientImage:function(){var i=this,n=i.get("gradientArr"),p=n.length,c=document.createElement("canvas"),f=c.getContext("2d"),a;c.width="256",c.height="15",a=f.createLinearGradient(0,5,256,10);for(var d=0;d<p;d++)a.addColorStop(1/(p-1)*d,n[d].value);f.fillStyle=a,f.fillRect(0,5,256,10),f.strokeStyle="black",f.beginPath();for(var d=0;d<p;d++)f.moveTo((1/(p-1)*d*256>>0)+.5,0),f.lineTo((1/(p-1)*d*256>>0)+.5,d==0?15:5);return f.moveTo(255.5,0),f.lineTo(255.5,15),f.moveTo(255.5,4.5),f.lineTo(0,4.5),f.stroke(),i.set("ctx",f),c.toDataURL()},getElement:function(){return this.get("element")},update:function(i){for(var n=this,p=n.get("gradientArr"),c=n.get("ctx"),f=n.get("labelsEl"),a,d="",_,b=0;b<p.length;b++)a=i*p[b].stop>>0,_=c.measureText(a).width/2>>0,b==0&&(_=0),b==p.length-1&&(_*=2),d+='<li style="position:absolute;left:'+(((1/(p.length-1)*b*256||0)>>0)-_+.5)+'px">'+a+"</li>";f.innerHTML=d}};var s=function(n){var p={radius:40,element:{},canvas:{},acanvas:{},ctx:{},actx:{},legend:null,visible:!0,width:0,height:0,max:!1,gradient:!1,opacity:180,premultiplyAlpha:!1,bounds:{l:1e3,r:0,t:1e3,b:0},debug:!1};this.store=new m(this),this.get=function(c){return p[c]},this.set=function(c,f){p[c]=f},this.configure(n),this.init()};return s.prototype={configure:function(i){var n=this;if(n.set("radius",i.radius||40),n.set("element",i.element instanceof Object?i.element:document.getElementById(i.element)),n.set("visible",i.visible!=null?i.visible:!0),n.set("max",i.max||!1),n.set("gradient",i.gradient||{.45:"rgb(0,0,255)",.55:"rgb(0,255,255)",.65:"rgb(0,255,0)",.95:"yellow",1:"rgb(255,0,0)"}),n.set("opacity",parseInt(255/(100/i.opacity),10)||180),n.set("width",i.width||0),n.set("height",i.height||0),n.set("debug",i.debug),i.legend){var p=i.legend;p.gradient=n.get("gradient"),n.set("legend",new e(p))}},resize:function(){var i=this,n=i.get("element"),p=i.get("canvas"),c=i.get("acanvas");p.width=c.width=i.get("width")||n.style.width.replace(/px/,"")||i.getWidth(n),this.set("width",p.width),p.height=c.height=i.get("height")||n.style.height.replace(/px/,"")||i.getHeight(n),this.set("height",p.height)},init:function(){var i=this,n=document.createElement("canvas"),p=document.createElement("canvas"),c=n.getContext("2d"),f=p.getContext("2d"),a=i.get("element");i.initColorPalette(),i.set("canvas",n),i.set("ctx",c),i.set("acanvas",p),i.set("actx",f),i.resize(),n.style.cssText=p.style.cssText="position:absolute;top:0;left:0;z-index:10000000;",i.get("visible")||(n.style.display="none"),a.appendChild(n),i.get("legend")&&a.appendChild(i.get("legend").getElement()),i.get("debug")&&document.body.appendChild(p),f.shadowOffsetX=15e3,f.shadowOffsetY=15e3,f.shadowBlur=15},initColorPalette:function(){var i=this,n=document.createElement("canvas"),p=i.get("gradient"),c,f,a;n.width="1",n.height="256",c=n.getContext("2d"),f=c.createLinearGradient(0,0,1,256),a=c.getImageData(0,0,1,1),a.data[0]=a.data[3]=64,a.data[1]=a.data[2]=0,c.putImageData(a,0,0),a=c.getImageData(0,0,1,1),i.set("premultiplyAlpha",a.data[0]<60||a.data[0]>70);for(var d in p)f.addColorStop(d,p[d]);c.fillStyle=f,c.fillRect(0,0,1,256),i.set("gradient",c.getImageData(0,0,1,256).data)},getWidth:function(i){var n=i.offsetWidth;return i.style.paddingLeft&&(n+=i.style.paddingLeft),i.style.paddingRight&&(n+=i.style.paddingRight),n},getHeight:function(i){var n=i.offsetHeight;return i.style.paddingTop&&(n+=i.style.paddingTop),i.style.paddingBottom&&(n+=i.style.paddingBottom),n},colorize:function(i,n){var p=this,c=p.get("width"),f=p.get("radius"),a=p.get("height"),d=p.get("actx"),_=p.get("ctx"),b=f*3,l=p.get("premultiplyAlpha"),M=p.get("gradient"),S=p.get("opacity"),P=p.get("bounds"),C,r,g,y,w,x,I,B,k;i!=null&&n!=null?(i+b>c&&(i=c-b),i<0&&(i=0),n<0&&(n=0),n+b>a&&(n=a-b),C=i,r=n,y=i+b,g=n+b):(P.l<0?C=0:C=P.l,P.r>c?y=c:y=P.r,P.t<0?r=0:r=P.t,P.b>a?g=a:g=P.b),w=d.getImageData(C,r,y-C,g-r),x=w.data.length;for(var T=3;T<x;T+=4)I=w.data[T],B=I*4,B&&(k=I<S?I:S,w.data[T-3]=M[B],w.data[T-2]=M[B+1],w.data[T-1]=M[B+2],l&&(w.data[T-3]/=255/k,w.data[T-2]/=255/k,w.data[T-1]/=255/k),w.data[T]=k);_.putImageData(w,C,r)},drawAlpha:function(i,n,p,c){var f=this,a=f.get("radius"),d=f.get("actx");f.get("max");var _=f.get("bounds"),b=i-1.5*a>>0,l=n-1.5*a>>0,M=i+1.5*a>>0,S=n+1.5*a>>0;d.shadowColor="rgba(0,0,0,"+(p?p/f.store.max:"0.1")+")",d.shadowOffsetX=15e3,d.shadowOffsetY=15e3,d.shadowBlur=15,d.beginPath(),d.arc(i-15e3,n-15e3,a,0,Math.PI*2,!0),d.closePath(),d.fill(),c?f.colorize(b,l):(b<_.l&&(_.l=b),l<_.t&&(_.t=l),M>_.r&&(_.r=M),S>_.b&&(_.b=S))},toggleDisplay:function(){var i=this,n=i.get("visible"),p=i.get("canvas");n?p.style.display="none":p.style.display="block",i.set("visible",!n)},getImageData:function(){return this.get("canvas").toDataURL()},clear:function(){var i=this,n=i.get("width"),p=i.get("height");i.store.set("data",[]),i.get("ctx").clearRect(0,0,n,p),i.get("actx").clearRect(0,0,n,p)},cleanup:function(){var i=this;i.get("element").removeChild(i.get("canvas"))}},{create:function(i){return new s(i)},util:{mousePosition:function(i){var n,p;if(i.layerX?(n=i.layerX,p=i.layerY):i.offsetX&&(n=i.offsetX,p=i.offsetY),typeof n!="undefined")return[n,p]}}}}(),v=function(m){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}if(!v._isExtended){v._isExtended=!0,o(v,BMap.Overlay,"HeatmapOverlay");var e=new v(m);this.__proto__=e.__proto__}this.conf=m,this.heatmap=null,this.latlngs=[],this.bounds=null,this._moveendHandler=this._moveendHandler.bind(this)};return v.prototype.initialize=function(m){this._map=m;var e=document.createElement("div");return e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.border=0,e.style.width=this._map.getSize().width+"px",e.style.height=this._map.getSize().height+"px",this.conf.element=e,m.getPanes().mapPane.appendChild(e),this.heatmap=u.create(this.conf),this._div=e,e},v.prototype.draw=function(){var m=this._map.getBounds();if(!m.equals(this.bounds)){this.bounds=m;var e=this._map.pointToOverlayPixel(m.getNorthEast()),s=this._map.pointToOverlayPixel(m.getSouthWest());if(!(!e||!s)){var i=e.y,n=s.x,p=s.y-e.y,c=e.x-s.x;if(this.conf.element.style.left=n+"px",this.conf.element.style.top=i+"px",this.conf.element.style.width=c+"px",this.conf.element.style.height=p+"px",this.heatmap.store.get("heatmap").resize(),this.latlngs.length>0){this.heatmap.clear();for(var f=this.latlngs.length,a={max:this.heatmap.store.max,data:[]};f--;){var d=this.latlngs[f].latlng;if(!!m.containsPoint(d)){var _=this._map.pointToOverlayPixel(d),b=new BMap.Pixel(_.x-n,_.y-i),l=this.pixelTransform(b);a.data.push({x:l.x,y:l.y,count:this.latlngs[f].c})}}this.heatmap.store.setDataSet(a)}}}},v.prototype.pixelTransform=function(m){for(var e=this.heatmap.get("width"),s=this.heatmap.get("height");m.x<0;)m.x+=e;for(;m.x>e;)m.x-=e;for(;m.y<0;)m.y+=s;for(;m.y>s;)m.y-=s;return m.x=m.x>>0,m.y=m.y>>0,m},v.prototype._moveendHandler=function(m){this.setDataSet(this._data),delete this._data,this._map.removeEventListener("moveend",this._moveendHandler)},v.prototype.setDataSet=function(m){if(!!this._map){var e=this._map.getBounds(),s=this._map.pointToOverlayPixel(e.getNorthEast()),i=this._map.pointToOverlayPixel(e.getSouthWest());(!s||!i)&&(this._data=m,this._map.addEventListener("moveend",this._moveendHandler));var n={max:m.max,data:[]},p=m.data,c=p.length;for(this.latlngs=[];c--;){var f=new BMap.Point(p[c].lng,p[c].lat);if(this.latlngs.push({latlng:f,c:p[c].count}),!!e.containsPoint(f)){var a=this._map.pointToOverlayPixel(f),d=this._map.pointToOverlayPixel(e.getSouthWest()).x,_=this._map.pointToOverlayPixel(e.getNorthEast()).y,b=new BMap.Pixel(a.x-d,a.y-_),l=this.pixelTransform(b);n.data.push({x:l.x,y:l.y,count:p[c].count})}}this.heatmap.clear(),this.heatmap.store.setDataSet(n)}},v.prototype.addDataPoint=function(m,e,s){var i=new BMap.Point(m,e),n=this.pixelTransform(this._map.pointToOverlayPixel(i));this.heatmap.store.addDataPoint(n.x,n.y,s),this.latlngs.push({latlng:i,c:s})},v.prototype.toggle=function(){this.heatmap.toggleDisplay()},v})})(ct);ct.exports;var pt={exports:{}};(function(t,h){(function(o,u){t.exports=u()})(Z,function(){function o(m,e){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}var s=u(m),i=new BMap.Polyline(s,e);return i.addEventListener("lineupdate",function(){this.isEditing&&this.enableEditing()}),i.cornerPoints=m,i.editMarkers=[],i.enableEditing=function(){var n=this;if(n.map){n.disableEditing();for(var p=0;p<n.cornerPoints.length;p++){var c=new BMap.Marker(n.cornerPoints[p],{icon:new BMap.Icon("http://api.map.baidu.com/library/CurveLine/1.5/src/circle.png",new BMap.Size(16,16)),enableDragging:!0,raiseOnDrag:!0});c.addEventListener("dragend",function(){n.cornerPoints.length=0;for(var f=0;f<n.editMarkers.length;f++)n.cornerPoints.push(n.editMarkers[f].getPosition());var a=u(n.cornerPoints);n.setPath(a)}),c.index=p,n.editMarkers.push(c),n.map.addOverlay(c)}}n.isEditing=!0},i.disableEditing=function(){this.isEditing=!1;for(var n=0;n<this.editMarkers.length;n++)this.map.removeOverlay(this.editMarkers[n]),this.editMarkers[n]=null;this.editMarkers.length=0},i.getPath=function(){return s},i}function u(m){for(var e=[],s=0;s<m.length-1;s++){var i=v(m[s],m[s+1]);i&&i.length>0&&(e=e.concat(i))}return e}function v(m,e){var s=[];if(!m||!e||!(m instanceof BMap.Point)||!(e instanceof BMap.Point))return null;var i=function(y){return 1-2*y+y*y},n=function(y){return 2*y-2*y*y},p=function(y){return y*y},c=30,f,a,d,_,b,l,M=0,S=0;if(typeof e=="undefined"){typeof s!="undefined"&&(s=[]);return}var P=parseFloat(m.lat),C=parseFloat(e.lat),r=parseFloat(m.lng),g=parseFloat(e.lng);for(g>r&&parseFloat(g-r)>180&&r<0&&(r=parseFloat(180+180+r)),r>g&&parseFloat(r-g)>180&&g<0&&(g=parseFloat(180+180+g)),l=0,C==P?(f=0,a=r-g):g==r?(f=Math.PI/2,a=P-C):(f=Math.atan((C-P)/(g-r)),a=(C-P)/Math.sin(f)),l==0&&(l=f+Math.PI/5),d=a/2,b=d*Math.cos(l)+r,_=d*Math.sin(l)+P,M=0;M<c+1;M++)s.push(new BMap.Point(r*i(S)+b*n(S)+g*p(S),P*i(S)+_*n(S)+C*p(S))),S=S+1/c;return s}return o})})(pt);pt.exports;const dt=t=>(yt("data-v-23ff4263"),t=t(),bt(),t),Xt={class:"main w pt10"},Ut={class:"round-edge pd10 bgf"},Yt={class:"pd10"},Jt=st("\u5E97\u94FA"),qt=st("\u5E97\u94FA\u4F4D\u7F6E"),Kt={class:"round-edge pd10 bgf mt20"},Qt=dt(()=>$("h3",{class:"pd10 mb20"},"\u5750\u6807\u8BBE\u7F6E",-1)),te={class:"ml20 mr20 mb20"},ee=dt(()=>$("div",{class:"mt10 ml20 mb10 f-gray f-13"},"\u6CE8\uFF1A\u5982\u5730\u56FE\u4E0D\u663E\u793A\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u68C0\u67E5\u662F\u5426\u6B63\u786E\u914D\u7F6E\u4E86\u767E\u5EA6\u5730\u56FEKEY",-1)),ie={setup(t){const h=q(!0),o=q({}),u=gt({lng:116.404,lat:39.915}),v=q(null);mt(()=>{o.value=JSON.parse(localStorage.getItem("visitor"))||{},Bt(null,s=>{v.value=s.baidukey},h)});const m=({BMap:s,map:i})=>{xt({store_id:o.value.store_id},n=>{Object.assign(u,{lat:parseFloat(n.latitude),lng:parseFloat(n.longitude)})})},e=s=>{let i=s.point;Mt({latitude:i.lat,longitude:i.lng},n=>{wt.success("\u5E97\u94FA\u5750\u6807\u8BBE\u7F6E\u6210\u529F\uFF01")})};return(s,i)=>{const n=H("el-col"),p=H("el-breadcrumb-item"),c=H("el-breadcrumb"),f=H("el-row");return j(),Y(_t,null,[E(St),$("div",Xt,[E(f,{gutter:12},{default:A(()=>[E(n,{span:4},{default:A(()=>[E(It)]),_:1}),E(n,{span:20},{default:A(()=>[$("div",Ut,[$("div",Yt,[E(c,{separator:"/"},{default:A(()=>[E(p,null,{default:A(()=>[Jt]),_:1}),E(p,null,{default:A(()=>[qt]),_:1})]),_:1})])]),$("div",Kt,[Qt,$("div",te,[v.value?(j(),vt(z($t),{key:0,class:"map",ak:v.value.browser,v:"3.0",type:"API",center:z(u),zoom:15,"scroll-wheel-zoom":!0,onReady:m},{default:A(()=>[E(z(Wt),{anchor:"BMAP_ANCHOR_TOP_LEFT"}),E(z(Rt),{anchor:"BMAP_ANCHOR_TOP_RIGHT"}),E(z(Nt),{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT",showAddressBar:!0,autoLocation:!0}),E(z(Ht),{position:z(u),dragging:!0,onDragend:e},{default:A(()=>[E(z(Vt),{content:o.value.store_name,labelStyle:{color:"red"},offset:{height:-20}},null,8,["content"])]),_:1},8,["position"])]),_:1},8,["ak","center"])):ot("",!0)]),ee])]),_:1})]),_:1})]),E(kt)],64)}}};var ce=Ct(ie,[["__scopeId","data-v-23ff4263"]]);export{ce as default};
