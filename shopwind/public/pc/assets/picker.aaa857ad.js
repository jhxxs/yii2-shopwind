import{r as V,x as F,z as M,d as c,o as m,g as O,h as s,f as h,j as v,c as $,t as S,i as C,b as Q,e as oe,a as t,w as se,F as N,l as G,k as H,B as ae,T as J,A as ne,E as ie,q as ce,v as re}from"./index.62034e5b.js";import{r as q,a as W}from"./blocks.8ce53700.js";import{m as de}from"./seller.c2523924.js";import{_ as ue}from"./user.01a6387e.js";import{m as _e}from"./seller.1ded1581.js";import{m as pe}from"./multiselector.f837aa0f.js";import"./chat.3e501cc2.js";/**
 * @link https://www.shopwind.net/
 * @copyright Copyright (c) 2018 ShopWind Inc. All Rights Reserved.
 *
 * This is not free software. Do not use it for commercial purposes. 
 * If you need commercial operation, please contact us to purchase a license.
 * @license https://www.shopwind.net/license/
 * 
 * @Id picker.js 2021.10.30 $
 * @author mosir
 */function fe(_,e,p){q("picker/add",_,a=>{a.code==0&&typeof e=="function"&&e(a)},p)}function me(_,e,p){q("picker/goods",_,a=>{a.code==0&&typeof e=="function"&&e(a.data)},p)}function ge(_,e,p){q("picker/category",_,a=>{a.code==0&&typeof e=="function"&&e(a.data)},p)}function be(_,e,p){q("picker/list",_,a=>{a.code==0&&typeof e=="function"&&e(a.data)},p)}const ve={class:"mb20 center"},he={key:0},ye=C(" \u6B63\u5728\u91C7\u96C6\u7B2C"),ke={class:"f-green"},xe={key:1},we=C(" \u5546\u54C1\u91C7\u96C6\u5B8C\u6BD5\uFF0C \u6210\u529F"),Ve={class:"f-green"},Ce=C("\u4E2A\uFF0C \u5931\u8D25"),$e={class:"f-red"},Ie=C("\u4E2A "),Oe={props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},data:{type:[Object,Array],default:()=>[]}},emits:["close"],setup(_,{emit:e}){const p=_,a=V(!1),i=F({total:0,number:0,success:0,fail:0});M(()=>p.visible,n=>{a.value=n}),M(()=>p.data,n=>{i.total=n.urls.length,i.number=0,i.success=0,i.fail=0,i.total>0&&setTimeout(()=>{g(n)},1e3)});const w=()=>{e("close")};function g(n){let o=n.urls[0].trim();fe({url:o,cate_id:n.cate_id,code:n.code},y=>{y.code==0?i.success++:i.fail++,n.urls.splice(n.urls.indexOf(o),1),i.number++,n.urls.length>0?g(n):setTimeout(()=>{e("close")},8e3)})}return(n,o)=>{const y=c("el-dialog");return m(),O(y,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=E=>a.value=E),title:_.title,width:500,center:!0,draggable:!0,"destroy-on-close":!1,"close-on-click-modal":!1,"show-close":v(i).total==v(i).number,"before-close":w},{default:s(()=>[h("div",ve,[v(i).total>v(i).number?(m(),$("p",he,[ye,h("span",ke,S(v(i).number+1),1),C(" / "+S(v(i).total)+"\u4E2A\u5546\u54C1 ",1)])):(m(),$("p",xe,[we,h("span",Ve,S(v(i).success),1),Ce,h("span",$e,S(v(i).fail),1),Ie]))])]),_:1},8,["modelValue","title","show-close"])}}};const Se=["src"],ze={class:"l-h17"},Ee={key:0,class:"l-h17"},Be={class:"f-yahei"},Ue={key:0,class:"mt20"},je=C("\u5173\u95ED"),Te=C("\u786E\u5B9A"),Ae={props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},limit:{type:Number,default:10}},emits:["close"],setup(_,{emit:e}){const p=_,a=V(!1),i=V(!1),w=V([]),g=V([]),n=V({total:0}),o=F({selected:[],code:"xyb2b"}),y=F([-1,-1,-1,-1]),{proxy:E}=ne();M(()=>p.visible,d=>{a.value=d});const L=d=>{B({page:d})};Q(()=>{B(),I()});const T=(d,l)=>{if(d>-1)y[l]=d,o.categoryId=g.value[l][d].id,I(o.categoryId,l+1);else{for(let u=l;u<y.length;++u)y[u]=-1;g.value.splice(l+1),l==0?o.categoryId=0:o.categoryId=g.value[l-1][y[l-1]].id}B()},r=(d,l)=>{let u=[];d.forEach(U=>{u.push(parseInt(U.goods_id))});let x=parseInt(l.goods_id);u.indexOf(x)>-1?o.selected.push(x):o.selected.indexOf(x)>-1&&o.selected.splice(o.selected.indexOf(x),1),o.selected=D()},f=d=>{d.length==0?w.value.forEach(l=>{let u=parseInt(l.goods_id);o.selected.indexOf(u)>-1&&o.selected.splice(o.selected.indexOf(u),1)}):d.forEach(l=>{o.selected.push(parseInt(l.goods_id))}),o.selected=D()},z=()=>{e("close",null)},A=()=>{e("close",o.selected)};function B(d){me(Object.assign({page_size:4},o,d),l=>{w.value=l.list||[],n.value=l.pagination||{},E.$nextTick(()=>{w.value.forEach(u=>{o.selected&&o.selected.indexOf(parseInt(u.goods_id))>-1&&E.$refs.multipleTableRef.toggleRowSelection(u,!0)})})},i)}function I(d=0,l=0){ge({categoryId:d,code:o.code},u=>{if(g.value.length>l){g.value.splice(l);for(let x=l;x<y.length;++x)y[x]=-1}g.value[g.value.length>0?l:0]=u})}function D(){return p.limit>0&&(o.selected=o.selected.splice(-p.limit)),J(o.selected)}return(d,l)=>{const u=c("el-option"),x=c("el-select"),U=c("el-form-item"),P=c("el-form"),k=c("el-table-column"),Y=c("el-table"),Z=c("el-pagination"),K=c("el-button"),ee=c("el-dialog"),te=oe("loading");return m(),O(ee,{modelValue:a.value,"onUpdate:modelValue":l[2]||(l[2]=b=>a.value=b),title:_.title,width:1e3,center:!0,draggable:!0,"destroy-on-close":!0,"close-on-click-modal":!1,"before-close":z},{footer:s(()=>[t(K,{onClick:z},{default:s(()=>[je]),_:1}),t(K,{type:"primary",onClick:A},{default:s(()=>[Te]),_:1})]),default:s(()=>[se((m(),$("div",null,[t(P,{inline:!0,class:"ml10"},{default:s(()=>[t(U,{label:"\u5546\u54C1\u7C7B\u76EE"},{default:s(()=>[(m(!0),$(N,null,G(g.value,(b,R)=>(m(),O(x,{modelValue:v(y)[R],"onUpdate:modelValue":j=>v(y)[R]=j,onChange:j=>T(j,R),class:"mr10 mb10"},{default:s(()=>[t(u,{label:"\u8BF7\u9009\u62E9",value:-1}),(m(!0),$(N,null,G(b,(j,le)=>(m(),O(u,{label:j.name,value:le},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]))),256))]),_:1})]),_:1}),t(Y,{ref:"multipleTableRef",data:w.value,border:!1,stripe:!1,onSelect:r,onSelectAll:f},{default:s(()=>[t(k,{fixed:"left",type:"selection"}),t(k,{width:"70",label:"\u56FE\u7247",align:"center"},{default:s(b=>[h("img",{src:b.row.default_image,width:"50",height:"50"},null,8,Se)]),_:1}),t(k,{label:"\u5546\u54C1\u540D\u79F0",width:"300"},{default:s(b=>[h("p",ze,S(b.row.goods_name),1)]),_:1}),t(k,{prop:"category",label:"\u6240\u5728\u5206\u7C7B",width:"220"},{default:s(b=>[b.row.category?(m(),$("p",Ee,S(b.row.category.join(" / ")),1)):H("",!0)]),_:1}),t(k,{prop:"price",label:"\u4EF7\u683C",width:"150",align:"center"},{default:s(b=>[h("p",Be,S(v(ae)(b.row.price)),1)]),_:1}),t(k,{prop:"stocks",label:"\u5E93\u5B58",width:"80",sortable:""}),t(k,{prop:"brand",label:"\u54C1\u724C",width:"100",sortable:""})]),_:1},8,["data"]),n.value.total>0?(m(),$("div",Ue,[t(Z,{currentPage:n.value.page,"onUpdate:currentPage":l[0]||(l[0]=b=>n.value.page=b),"page-size":n.value.page_size,"onUpdate:page-size":l[1]||(l[1]=b=>n.value.page_size=b),background:!1,layout:"total, prev, pager, next",total:n.value.total,onCurrentChange:L,"hide-on-single-page":!1,class:"center"},null,8,["currentPage","page-size","total"])])):H("",!0)])),[[te,i.value]])]),_:1},8,["modelValue","title"])}}};var De=W(Ae,[["__scopeId","data-v-7c7265d6"]]);const X=_=>(ce("data-v-35d0c31a"),_=_(),re(),_),Fe={class:"main w pt10"},Ne={class:"round-edge pd10 bgf"},qe={class:"pd10"},Le=C("\u5546\u54C1"),Pe=C("\u91C7\u96C6\u5546\u54C1"),Re={class:"round-edge pd10 bgf mt20"},Me={class:"pl10 pt10"},Ge=X(()=>h("p",{class:"f-gray f-12 w-full"},"\u6CE8\uFF1A\u6BCF\u4E2A\u94FE\u63A5\u653E\u4E00\u884C",-1)),He=C("\u91C7\u96C6\u63D2\u4EF6\u672A\u914D\u7F6E"),Je={class:"f-gray l-h17 f-12 textarea"},Ke=X(()=>h("text",{class:"pl10 pr10"},"\u5F00\u59CB\u91C7\u96C6",-1)),Qe={setup(_){const e=F({urls:"",code:""}),p=V(!1),a=V(!1),i=V([]),w=V([]),g=V("");Q(()=>{be(null,r=>{w.value=r,r.length>0&&(e.code=r[0].code,g.value=r[0].summary)})});const n=()=>{let r=e.urls.trim().length>0?e.urls.trim().split(`
`):[];for(let f=0;f<r.length;f++)r[f]=r[f].trim();e.urls=J(r).join(`
`)},o=r=>{e.cate_id=r.id},y=r=>{w.value.forEach(f=>{f.code==r&&(g.value=f.summary)})},E=()=>{e.code=="xyb2b"&&(a.value=!0)},L=()=>{e.urls.length>0&&e.code?(p.value=!0,i.value=Object.assign({},e,{urls:e.urls.split(`
`)})):ie.warning("\u5546\u54C1\u94FE\u63A5\u53CA\u5546\u54C1\u6765\u6E90\u4E0D\u80FD\u4E3A\u7A7A")},T=r=>{if(p.value=!1,a.value=!1,r&&e.code=="xyb2b"){let f=[];J(r).forEach(z=>{f.push("https://www.xyb2b.com/buyer/mall/goodDetail?skuId="+z)}),e.urls=f.join(`
`)}};return(r,f)=>{const z=c("el-col"),A=c("el-breadcrumb-item"),B=c("el-breadcrumb"),I=c("el-form-item"),D=c("el-input"),d=c("el-option"),l=c("el-select"),u=c("el-tag"),x=c("el-button"),U=c("el-form"),P=c("el-row");return m(),$(N,null,[t(de),h("div",Fe,[t(P,{gutter:12},{default:s(()=>[t(z,{span:4},{default:s(()=>[t(_e)]),_:1}),t(z,{span:20},{default:s(()=>[h("div",Ne,[h("div",qe,[t(B,{separator:"/"},{default:s(()=>[t(A,null,{default:s(()=>[Le]),_:1}),t(A,null,{default:s(()=>[Pe]),_:1})]),_:1})])]),h("div",Re,[h("div",Me,[t(U,null,{default:s(()=>[t(I,{label:"\u5546\u54C1\u7C7B\u76EE"},{default:s(()=>[t(pe,{api:"category/list",idField:"cate_id",nameField:"cate_name",parentField:"parent_id",placeholder:!1,onCallback:o})]),_:1}),t(I,{label:"\u5546\u54C1\u94FE\u63A5"},{default:s(()=>[t(D,{onClick:E,modelValue:v(e).urls,"onUpdate:modelValue":f[0]||(f[0]=k=>v(e).urls=k),onBlur:n,type:"textarea",resize:"none",rows:"10",class:"textarea",readonly:v(e).code=="xyb2b"},null,8,["modelValue","readonly"]),Ge]),_:1}),t(I,{label:"\u91C7\u96C6\u5E73\u53F0"},{default:s(()=>[w.value.length>0?(m(),O(l,{key:0,onChange:y,modelValue:v(e).code,"onUpdate:modelValue":f[1]||(f[1]=k=>v(e).code=k)},{default:s(()=>[(m(!0),$(N,null,G(w.value,k=>(m(),O(d,{label:k.name,value:k.code},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])):(m(),O(u,{key:1,size:"large"},{default:s(()=>[He]),_:1}))]),_:1}),g.value?(m(),O(I,{key:0,label:" ","label-width":68},{default:s(()=>[h("p",Je,S(g.value),1)]),_:1})):H("",!0),t(I,{"label-width":68},{default:s(()=>[t(x,{onClick:L,type:"primary",class:"mt20"},{default:s(()=>[Ke]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1})]),t(De,{title:"\u9009\u62E9\u5546\u54C1",visible:a.value,limit:10,onClose:T},null,8,["visible"]),t(Oe,{title:"\u91C7\u96C6\u5546\u54C1",visible:p.value,data:i.value,onClose:T},null,8,["visible","data"]),t(ue)],64)}}};var ot=W(Qe,[["__scopeId","data-v-35d0c31a"]]);export{ot as default};
