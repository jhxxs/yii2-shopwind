import{r as i,_ as c}from"./blocks.8ce53700.js";import{D as f,E as s,m as u,d as g,o as l,c as d,a as r,F as m}from"./index.62034e5b.js";import{c as p}from"./chat.3e501cc2.js";/**
 * @link https://www.shopwind.net/
 * @copyright Copyright (c) 2018 ShopWind Inc. All Rights Reserved.
 *
 * This is not free software. Do not use it for commercial purposes. 
 * If you need commercial operation, please contact us to purchase a license.
 * @license https://www.shopwind.net/license/
 * 
 * @Id user.js 2020.10.25 $
 * @author mosir
 */function v(t,o,a){i("user/read",t,e=>{e.code==0&&typeof o=="function"&&o(e.data)},a)}function h(t,o,a){i("user/update",t,e=>{if(e.code==0){let n=JSON.parse(localStorage.getItem("visitor"));localStorage.setItem("visitor",JSON.stringify(Object.assign(n,{portrait:e.data.portrait}))),typeof o=="function"&&o(e.data)}else s.warning(e.message)},a)}function w(t,o,a){t.verifycodekey=localStorage.getItem("smsverifycodekey"),i("user/password",t,e=>{e.code==0?typeof o=="function"&&o(e.data):s.warning(e.message)},a)}function I(t,o,a){t.verifycodekey=localStorage.getItem("smsverifycodekey"),i("user/phone",t,e=>{if(e.code==0){let n=JSON.parse(localStorage.getItem("visitor"));localStorage.setItem("visitor",JSON.stringify(Object.assign(n,{phone_mob:e.data.phone_mob}))),typeof o=="function"&&o(e.data)}else s.warning(e.message)},a)}function x(t,o,a){i("auth/login",t,e=>{if(e.code==0&&e.data)if(e.data.user_info){if(t.requiresSeller&&!e.data.user_info.store_id)return f({title:"\u63D0\u793A",message:"\u60A8\u8FD8\u4E0D\u662F\u5356\u5BB6",showCancelButton:!1,type:"warning"});localStorage.setItem("access_token",e.data.token),localStorage.setItem("visitor",JSON.stringify(e.data.user_info)),typeof o=="function"&&o(e.data)}else s.warning("\u767B\u5F55\u5931\u8D25");else f({title:"\u63D0\u793A",message:e.message?e.message:"\u672A\u77E5\u9519\u8BEF",showCancelButton:!1,type:"warning"})},a)}function O(t){localStorage.removeItem("access_token"),localStorage.removeItem("visitor"),typeof t=="function"?t():u("/user/login")}function B(t,o,a){i("auth/connect",t,e=>{e.code==0?typeof o=="function"&&o(e.data):f({title:"\u63D0\u793A",message:e.message?e.message:"\u672A\u77E5\u9519\u8BEF",showCancelButton:!1,type:"warning"})},a)}const E={props:{page:{type:String,default:""},exclude:{type:Array,default(){return[]}}},setup(t){return(o,a)=>{const e=g("el-backtop");return l(),d(m,null,[r(c,{page:t.page,footer:!0,exclude:t.exclude},null,8,["page","exclude"]),r(e,{right:10,bottom:100,"visibility-height":50}),r(p)],64)}}};export{E as _,v as a,h as b,I as c,w as d,x as e,B as f,O as u};
